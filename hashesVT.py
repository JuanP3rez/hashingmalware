import requests
import hashlib

api_key = 'api de virusTotal'
ruta = input("ruta o nombre del archivo: ")

# Generar hash del archivo
sha256_hash = hashlib.sha256()
with open(ruta, 'rb') as f:
    for byte_block in iter(lambda: f.read(4096), b""):
        sha256_hash.update(byte_block)
file_hash = sha256_hash.hexdigest()

# Hacer una solicitud a la API de VirusTotal para comprobar si el hash est√° en la base de datos de malware
url = f'https://www.virustotal.com/api/v3/files/{file_hash}'
headers = {'x-apikey': api_key}
response = requests.get(url, headers=headers)

# Analizar la respuesta de la API
if response.status_code == 200:
    response_json = response.json()
    if response_json['data']['attributes']['last_analysis_stats']['malicious'] == 0:
        print('El archivo no es malware')
    else:
        print('El archivo es malware')
        for antivirus in response_json['data']['attributes']['last_analysis_results']:
            if response_json['data']['attributes']['last_analysis_results'][antivirus]['category'] == 'malicious':
                print(f"Nombre del antivirus: {antivirus}")
else:
    print('Error en la solicitud a la API')
